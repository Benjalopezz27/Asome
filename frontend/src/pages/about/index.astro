---
import Advice from "@/components/common/Advice.astro";
import Layout from "@/layouts/Layout.astro";
import { getHeroPages, getHomePageData } from "@/lib/data";
import Newsletter from "@/components/blocks/Newsletter.astro";
import type { NewsletterBlock } from "../../types/index";
import HeroPages from "@/components/common/HeroPages.astro";

// 1. EXTRAER EL NEWSLETTER: Buscamos si existe el bloque en la data
const { blocks } = await getHomePageData();
const globalHero = await getHeroPages();
const aboutHero = globalHero[1];
const heroProps = aboutHero
  ? {
      title: aboutHero.title,
      description: aboutHero.description,
    }
  : null;
const newsletterData = blocks?.find(
  (b) => b.__component === "blocks.newsletter"
) as NewsletterBlock | undefined;
---

<Layout>
  {heroProps && <HeroPages {...heroProps} />}
  <Advice />
  {
    newsletterData && (
      <div class="relative z-10 -mt-24 mb-10">
        <Newsletter {...newsletterData} />
      </div>
    )
  }
</Layout>
